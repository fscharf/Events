@using System.Security.Claims;
@model Events.Models.INSCRICAO

@{
    var userAuth = (ClaimsIdentity)User.Identity;
}
@if (userAuth.IsAuthenticated && TempData["Success"] != null)
{
    <div class="row">
        <div class="col-lg-6 mb-3 mb-sm-0">
            <img class="img-fluid" src="~/Content/img/undraw/undraw_High_five_u364.svg" alt="ilustração" />
        </div>
        <div class="col-lg-6 text-center">
            <h1 class="font-weight-bold">Parabéns, @userAuth.Claims.Where(c => c.Type == ClaimTypes.GivenName).FirstOrDefault().Value</h1>
            <h3 class="font-weight-bold">@TempData["Success"]</h3>
            <p class="text-muted mb-4">Aposto que vai ser o melhor evento da sua vida!</p>

            <h4 class="text-muted mb-0">Código de inscrição: @Html.DisplayFor(x => x.COD_INSCRICAO)</h4>
            <h4 class="text-muted mb-0">Data/hora de inscrição: @Html.DisplayFor(x => x.DATA_HORA_INSC)</h4>
            <img src="https://chart.googleapis.com/chart?cht=qr&chl=@Html.DisplayFor(x => x.COD_INSCRICAO).ToString()&chs=180x180&choe=UTF-8&chld=L|2"
                 alt="QR Code"
                 title="@Html.DisplayFor(x => x.COD_INSCRICAO)">
            <br />
            <small class="text-muted">Apresente o código de inscrição ou QR Code para validar sua presença quando estiver no evento.</small>

            <div class="mb-3"></div>

            <div class="btn-group">
                <a class="btn btn-outline-primary" href="/"><i class="fas fa-arrow-left"></i> Voltar ao início</a>
                <a class="btn btn-outline-primary" href="#"><i class="fas fa-print"></i> Imprimir</a>
                <a class="btn btn-outline-primary" href="@Url.Action("MyEvents", "Events")"><i class="fas fa-calendar-alt"></i> Ir aos meus eventos</a>
            </div>
        </div>
    </div>
}
else
{
    Response.Redirect("/Users/Login");
}

@section scripts {
    <script>
        $(function () {
            var errorMsg = '@TempData["Error"]';

            if (errorMsg != '') {
                iziToast.error({
                title: 'Erro',
                message: errorMsg
                });
            }
        })
    </script>
}




